# ============================================================
# Workflow Orchestrator â€” Environment Configuration
# Copy this file to .env and adjust values for your environment.
# ============================================================

# --- Application ---
APP_NAME=Workflow Orchestrator
APP_VERSION=1.0.0

# --- Database ---
DATABASE_URL=postgresql+asyncpg://workflow:workflow@localhost:5432/workflow
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30

# --- Redis ---
REDIS_URL=redis://localhost:6379/0

# --- Logging ---
LOG_LEVEL=INFO

# --- Worker: batch & polling ---
WORKER_BATCH_SIZE=50
WORKER_BLOCK_MS=2000
WORKER_ENABLE_DELAYS=true

# Worker: simulated delay ranges (milliseconds)
WORKER_IO_DELAY_MS=100
WORKER_INPUT_MIN_MS=50
WORKER_INPUT_MAX_MS=150
WORKER_EXTERNAL_MIN_MS=1000
WORKER_EXTERNAL_MAX_MS=2000
WORKER_LLM_MIN_MS=1500
WORKER_LLM_MAX_MS=2500
WORKER_DECISION_MIN_MS=10
WORKER_DECISION_MAX_MS=50

# Worker: handler fallback defaults
WORKER_DEFAULT_EXTERNAL_URL=http://example.com/api
WORKER_DEFAULT_LLM_MODEL=gpt-4
WORKER_DEFAULT_LLM_TEMPERATURE=0.7
WORKER_DEFAULT_LLM_MAX_TOKENS=1000

# Worker: retry / backoff
WORKER_MAX_RETRIES=3
WORKER_BACKOFF_BASE_SECONDS=1.0
WORKER_BACKOFF_MAX_SECONDS=30.0
WORKER_BACKOFF_JITTER_MAX=0.5
WORKER_IDEMPOTENCY_TTL_SECONDS=86400
WORKER_ERROR_PAUSE_SECONDS=1.0

# --- Orchestrator ---
ORCHESTRATOR_BATCH_SIZE=100
ORCHESTRATOR_BLOCK_MS=2000
ORCHESTRATOR_TIMEOUT_CHECK_INTERVAL_SECONDS=1.0

# --- Reaper ---
REAPER_CHECK_INTERVAL_SECONDS=60
REAPER_MIN_IDLE_SECONDS=300
REAPER_BATCH_SIZE=10

# --- Distributed Lock ---
LOCK_TTL_SECONDS=30

# --- Workflow metadata TTL ---
EXECUTION_METADATA_TTL_SECONDS=86400

# --- Redis Streams ---
STREAM_TASK_KEY=workflow:tasks
STREAM_COMPLETION_KEY=workflow:completions
STREAM_DLQ_KEY=workflow:dlq
STREAM_DLQ_INDEX_KEY=workflow:dlq:index
STREAM_TASK_GROUP=task_workers
STREAM_COMPLETION_GROUP=orchestrators
STREAM_MAX_LEN=10000

# --- Rate Limiting ---
RATE_LIMIT_REQUESTS_PER_MINUTE=300
RATE_LIMIT_BURST_SIZE=10
RATE_LIMIT_ENABLED=true

# --- Circuit Breaker ---
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RESET_TIMEOUT_SECONDS=60
CIRCUIT_BREAKER_HALF_OPEN_MAX_CALLS=2
CIRCUIT_BREAKER_ENABLED=true

# --- Dead Letter Queue ---
DLQ_MAX_RETRIES=3
DLQ_ENABLED=true

# --- Concurrency ---
MAX_CONCURRENT_DB_OPERATIONS=50
